% Pseudo-code for Granule De-clustering
spotData = readtable('Imaris_Export.xlsx'); % Read data from Excel
meanGranuleArea = mean(spotData.Area(spotData.Area < singleGranuleAreaThreshold));

for i = 1:height(spotData)
    if spotData.Area(i) > meanGranuleArea * 1.5
        % This is a potential cluster. Estimate granule count.
        estimatedCount = round(spotData.Area(i) / meanGranuleArea);
        % Assign the count (this is used for final tally)
        spotData.AdjustedCount(i) = estimatedCount;
    else
        % This is a single granule.
        spotData.AdjustedCount(i) = 1;
    end
end

% The final "Granules per Cell" is the sum of AdjustedCount
totalGranules = sum(spotData.AdjustedCount);
